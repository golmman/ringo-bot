!function(e){var n={};function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}t.m=e,t.c=n,t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:o})},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(t.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var i in e)t.d(o,i,function(n){return e[n]}.bind(null,i));return o},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p="",t(t.s=6)}([function(e,n){e.exports={EMPTY:0,MARKED:1,BLUE_DISK:1e3,RED_DISK:2e3,BLUE_RING:3e3,RED_RING:4e3,MAX_DISKS:10,MAX_RINGS:4,DROP_DISK:-1,GRID_SIZE:256,GRID_SIZE2:65536,BLUE:0,RED:1,OPPONENT_PHASE:0,PICK_DISK_PHASE:1,DROP_DISK_PHASE:2,DROP_RING_PHASE:3}},function(e,n,t){const{intDiv:o}=t(2),{EMPTY:i,BLUE_DISK:s,RED_DISK:r,BLUE_RING:d,RED_RING:a,GRID_SIZE:c}=t(0);function u(e,n,t){e.grid[t]=n}function l(e,n){const t=e.grid[n];return e.grid[n]=i,t}function f(e,n,t){u(e,n,t),e.blueDisks.add(t)}function v(e,n,t){u(e,n,t),e.redDisks.add(t)}function g(e,n,t){u(e,n,t),e.blueRings.add(t)}function k(e,n,t){u(e,n,t),e.redRings.add(t)}function R(e){return 1===o(e,1e3)}function w(e){return 2===o(e,1e3)}function D(e){return 3===o(e,1e3)}function b(e){return 4===o(e,1e3)}function M(e){return`[34m${e}[0m`}function m(e){return`[31m${e}[0m`}function h(e){return R(e)?"b":w(e)?"r":D(e)?"B":b(e)?"R":"-"}function S(e){return R(e)?M("b"+(e-s)):w(e)?m("r"+(e-r)):D(e)?M("B"+(e-d)):b(e)?m("R"+(e-a)):"--"}function p(e){return R(e)?M("â€¢"):w(e)?m("â€¢"):D(e)?M("O"):b(e)?m("O"):"Â·"}function T(e,n){e.duplicationMarkers=[],e.grid=new Array(c*c).fill(i),e.blueDisks=new Set,e.redDisks=new Set,e.blueRings=new Set,e.redRings=new Set,e.isBlueTurn=!0;const t=c/2;return function(e){return e.split("\n").map(e=>e.replace(/\s/g,"")).filter(e=>e.length>0).map(e=>e.split(""))}(n).forEach((n,o)=>{n.forEach((n,i)=>{const u=c*(o+t)+i+t;switch(n){case"b":f(e,s+e.blueDisks.size,u);break;case"r":v(e,r+e.redDisks.size,u);break;case"B":g(e,d+e.blueRings.size,u);break;case"R":k(e,a+e.redRings.size,u)}})}),e}e.exports={addBlueDisk:f,addBlueRing:g,addRedDisk:v,addRedRing:k,deleteBlueDisk:function(e,n){const t=l(e,n);return e.blueDisks.delete(n),t},deleteBlueRing:function(e,n){const t=l(e,n);return e.blueRings.delete(n),t},deleteRedDisk:function(e,n){const t=l(e,n);return e.redDisks.delete(n),t},deleteRedRing:function(e,n){const t=l(e,n);return e.redRings.delete(n),t},getCoords:function(e){return{x:e%c,y:o(e,c)}},getGridIndex:function({x:e,y:n}){return c*n+e},initBoard:function(e){T(e,"\n        BRB\n        R0R\n        BRB\n    ")},isBlueDisk:R,isBlueRing:D,isDisk:function(e){const n=o(e,1e3);return 1===n||2===n},isRedDisk:w,isRedRing:b,isRing:function(e){const n=o(e,1e3);return 3===n||4===n},printBoard:function(e,n){const t={xMin:c,yMin:c,xMax:0,yMax:0};e.grid.forEach((e,n)=>{if(e){const e=n%c,i=o(n,c);e<t.xMin&&(t.xMin=e),i<t.yMin&&(t.yMin=i),e>t.xMax&&(t.xMax=e),i>t.yMax&&(t.yMax=i)}});let i=p;if(n)switch(n.pieceMapper){case"simple":i=h;break;case"exact":i=S;break;default:i=p}for(let n=t.yMin;n<=t.yMax;n+=1){const o=c*n+t.xMin,s=c*n+t.xMax+1;e.grid.slice(o,s).map(e=>i(e)).join(" ")}},setupBoard:T}},function(e,n){e.exports={getRandomInt:function(e){return Math.floor(Math.random()*e)},intDiv:function(e,n){return e/n|0},mergeSets:function(e,n){return new Set(function*(){yield*e,yield*n}())}}},function(e,n,t){const o=t(0),i={};e.exports={context:i,resetContext:function(){i.canvas=null,i.events={mouseWheel:null,mouseDown:null,mouseMove:{clientX:0,clientY:0},isMouseDown:!1,phase:null},i.draw={move:{diskFrom:-1,diskTo:-1,ringTo:-1},lastMove:{diskFrom:-1,diskTo:-1,ringTo:-1},generatedMoves:null,pickDiskMoves:null,dropDiskMoves:null,dropRingMoves:null,winner:null},i.board={canvasX:100,canvasY:100,tileSize:100,botColor:o.RED,isBlueTurn:!0,activeDisks:null,duplicationMarkers:[],grid:[],blueDisks:new Set,redDisks:new Set,blueRings:new Set,redRings:new Set}}}},function(e,n,t){const{isBlueRing:o}=t(1),{context:i}=t(3),{getCoords:s}=t(1),{GRID_SIZE:r,OPPONENT_PHASE:d,PICK_DISK_PHASE:a,DROP_DISK_PHASE:c,DROP_RING_PHASE:u}=t(0);function l({x:e,y:n}){const{canvasX:t,canvasY:o,tileSize:s}=i.board;return{x:t+(e-r/2)*s,y:o+(n-r/2)*s}}function f(e,{x:n,y:t}){const{tileSize:o}=i.board;e.beginPath(),e.fillStyle="rgb(24, 24, 160)",e.arc(n+o/2,t+o/2,.3*o,0,2*Math.PI),e.fill()}function v(e,{x:n,y:t}){const{tileSize:o}=i.board;e.beginPath(),e.fillStyle="rgb(160, 24, 24)",e.arc(n+o/2,t+o/2,.3*o,0,2*Math.PI),e.fill()}function g(e,{x:n,y:t}){const{tileSize:o}=i.board;e.beginPath(),e.strokeStyle="rgb(24, 24, 160)",e.lineWidth=.1*o,e.arc(n+o/2,t+o/2,.4*o,0,2*Math.PI),e.stroke()}function k(e,{x:n,y:t}){const{tileSize:o}=i.board;e.beginPath(),e.strokeStyle="rgb(160, 24, 24)",e.lineWidth=.1*o,e.arc(n+o/2,t+o/2,.4*o,0,2*Math.PI),e.stroke()}function R(e){!function(e){const{blueDisks:n,isBlueTurn:t}=i.board,{move:o}=i.draw;if(n.forEach(n=>{const t=l(s(n));o.diskFrom!==n&&f(e,t)}),o.diskTo>0&&t){const n=l(s(o.diskTo));f(e,n)}}(e),function(e){const{redDisks:n,isBlueTurn:t}=i.board,{move:o}=i.draw;if(n.forEach(n=>{const t=l(s(n));o.diskFrom!==n&&v(e,t)}),o.diskTo>0&&!t){const n=l(s(o.diskTo));v(e,n)}}(e),function(e){const{blueRings:n}=i.board,{move:t}=i.draw;n.forEach(n=>{const o=l(s(n));t.diskTo!==n&&g(e,o)})}(e),function(e){const{redRings:n}=i.board,{move:t}=i.draw;n.forEach(n=>{const o=l(s(n));t.diskTo!==n&&k(e,o)})}(e)}e.exports={redraw:function(){const e=i.canvas.getContext("2d");e.clearRect(0,0,i.canvas.width,i.canvas.height),function(e){const{lastMove:n}=i.draw,{tileSize:t}=i.board,o=[];-1!==n.diskFrom&&o.push(n.diskFrom),-1!==n.diskTo&&o.push(n.diskTo),-1!==n.ringTo&&o.push(n.ringTo),o.forEach(n=>{const o=l(s(n));e.fillStyle="rgb(48, 24, 24)",e.fillRect(o.x,o.y,t,t)}),o.forEach((n,o)=>{const i=l(s(n)),r=t/5,d=2===o?i.y+t:i.y+r;e.font=r+"px monospace",e.fillStyle="rgb(192, 192, 192)",e.fillText(""+(o+1),i.x,d)})}(e),function(e){const{tileSize:n}=i.board,{phase:t}=i.events;let o=new Set;t!==d&&(t===a&&(o=i.draw.pickDiskMoves),t===c&&(o=i.draw.dropDiskMoves),t===u&&(o=i.draw.dropRingMoves),o.forEach(t=>{const o=l(s(t));e.fillStyle="rgba(16, 64, 16, 0.5)",e.fillRect(o.x,o.y,n,n)}))}(e),function(e){const{tileSize:n}=i.board,t=i.board.canvasX%n,o=i.board.canvasY%n,s=i.canvas.width,r=i.canvas.height;e.strokeStyle="rgb(160, 160, 160)",e.lineWidth=1;for(let o=t;o<=s;o+=n)e.beginPath(),e.moveTo(o,0),e.lineTo(o,r),e.stroke();for(let t=o;t<=r;t+=n)e.beginPath(),e.moveTo(0,t),e.lineTo(s,t),e.stroke()}(e),function(e){const{canvasX:n,canvasY:t,tileSize:o}=i.board,s=i.canvas.getBoundingClientRect(),r=i.events.mouseMove.clientX-s.left,d=i.events.mouseMove.clientY-s.top,a=r-n,c=d-t,u=a>0?r-a%o:r-a%o-o,l=c>0?d-c%o:d-c%o-o;e.fillStyle="rgb(48, 48, 48)",e.fillRect(u,l,o,o)}(e),function(e){const{canvasX:n,canvasY:t,tileSize:o}=i.board;e.strokeStyle="rgb(192, 192, 192)",e.lineWidth=3,e.beginPath(),e.moveTo(n-o,t),e.lineTo(n+o,t),e.stroke(),e.beginPath(),e.moveTo(n,t-o),e.lineTo(n,t+o),e.stroke()}(e),R(e),function(e){const{phase:n}=i.events,{move:t}=i.draw,{tileSize:s,isBlueTurn:r,grid:l}=i.board,R=i.canvas.getBoundingClientRect(),w=i.events.mouseMove.clientX-R.left,D=i.events.mouseMove.clientY-R.top;if(n!==d&&n!==a){if(n===c){const n=w-s/2,t=D-s/2;r?f(e,{x:n,y:t}):v(e,{x:n,y:t})}if(n===u){const n=w-s/2,i=D-s/2;o(l[t.diskTo])?g(e,{x:n,y:i}):k(e,{x:n,y:i})}}}(e),function(e){const{winner:n}=i.draw,{width:t,height:o}=i.canvas;if(null===n)return;const s=.33*o,r=.75*t,d=.125*t,a=.66*o,c=["you win","you lose"][n];e.font=s+"px monospace",e.fillStyle="rgb(192, 192, 192)",e.fillText(c,d,a,r)}(e)}}},function(e,n,t){const{getRandomInt:o}=t(2),{addBlueDisk:i,addBlueRing:s,addRedDisk:r,addRedRing:d,deleteBlueDisk:a,deleteBlueRing:c,deleteRedDisk:u,deleteRedRing:l,isBlueRing:f,isRing:v}=t(1),{mergeSets:g}=t(2),{BLUE_DISK:k,EMPTY:R,GRID_SIZE:w,MAX_DISKS:D,RED_DISK:b}=t(0),M=[-1,1,-w,w],m=new Set(M);function h(e,n){const t=new Set;for(const o of n)for(const n of M){const i=o+n,s=e.grid[i];v(s)||t.add(i)}return t}function S(e,{diskFrom:n,diskTo:t,ringTo:o}){return(e.grid[o]===R||o===n)&&(i=t,s=o,!(m.has(i-s)&&function(e,n){let t=0;for(const o of M)v(e.grid[n+o])&&(t+=1);return t}(e,o)<2));var i,s}function p(e){const n=[],t=g(e.blueRings,e.redRings),o=h(e,t),i=t,s=function(e){const n=e.isBlueTurn?e.blueDisks:e.redDisks;return n.size<D?[-1]:Array.from(n)}(e);for(const t of o)for(const o of i)for(const i of s){const s={diskFrom:i,diskTo:o,ringTo:t};S(e,s)&&n.push(s)}return n}e.exports={generateMoves:p,generateRandomMove:function(e){const n=p(e);return n[o(n.length)]},generateRingDrops:h,makeMove:function(e,{diskFrom:n,diskTo:t,ringTo:o}){const v=e.isBlueTurn?k+e.blueDisks.size:b+e.redDisks.size,{addDisk:g,deleteDisk:R}=e.isBlueTurn?{addDisk:i,deleteDisk:a}:{addDisk:r,deleteDisk:u},w=e.grid[t],{addRing:D,deleteRing:M}=f(w)?{addRing:s,deleteRing:c}:{addRing:d,deleteRing:l},m=n>0?R(e,n):v,h=M(e,t);return g(e,m,t),D(e,h,o),1},unmakeMove:function(e,{diskFrom:n,diskTo:t,ringTo:o}){return 1}}},function(e,n,t){const{context:o,resetContext:i}=t(3),{initBoard:s}=t(1),{redraw:r}=t(4),{handleKeyDown:d,handleMouseClick:a,handleMouseDown:c,handleMouseMove:u,handleMouseUp:l,handleMouseWheel:f,restartPhases:v}=t(7);function g(){const e=document.getElementById("gameCanvas");e.width=.8*window.innerWidth,e.height=.8*window.innerHeight,o.canvas=e,r()}function k(e){i(),s(o.board),g(),v()}window.addEventListener("contextmenu",e=>{e.preventDefault()}),window.addEventListener("resize",g),window.addEventListener("keydown",d),window.addEventListener("click",a),window.addEventListener("mousedown",c),window.addEventListener("mousemove",u),window.addEventListener("mouseup",l),window.addEventListener("wheel",f),window.onload=()=>k(),window.restartGame=k},function(e,n,t){const{context:o}=t(3),{redraw:i}=t(4),{generateMoves:s,makeMove:r}=t(5),{intDiv:d}=t(2),{findBestMove:a}=t(8),{isBlueDiskWinAt:c,isRedDiskWinAt:u,isBlueRingWinAt:l,isRedRingWinAt:f}=t(9),{BLUE:v,DROP_DISK_PHASE:g,DROP_RING_PHASE:k,GRID_SIZE:R,MAX_DISKS:w,OPPONENT_PHASE:D,PICK_DISK_PHASE:b,RED:M}=t(0);function m(e){const{generatedMoves:n}=o.draw;o.draw.dropDiskMoves=new Set;for(let t=0;t<n.length;t+=1)e===n[t].diskFrom&&o.draw.dropDiskMoves.add(n[t].diskTo)}function h(){o.draw.generatedMoves=s(o.board),o.draw.move={diskFrom:-1,diskTo:-1,ringTo:-1};(o.board.isBlueTurn?o.board.blueDisks:o.board.redDisks).size<w?(o.events.phase=g,m(-1)):(o.events.phase=b,function(){const{generatedMoves:e}=o.draw;o.draw.pickDiskMoves=new Set;for(let n=0;n<e.length;n+=1)-1!==e[n].diskFrom&&o.draw.pickDiskMoves.add(e[n].diskFrom)}()),i()}function S(e){const{board:n}=o;return c(n,e.diskTo)||l(n,e.ringTo)?v:u(n,e.diskTo)||f(n,e.ringTo)?M:null}e.exports={handleKeyDown:function(e){const{phase:n}=o.events;70===e.keyCode&&n===D&&h()},handleMouseClick:function(e){const{phase:n}=o.events;if(n===D)return;const{pickDiskMoves:t,dropDiskMoves:s,dropRingMoves:c}=o.draw,u=o.canvas.getBoundingClientRect(),l=function({x:e,y:n}){const{canvasX:t,canvasY:i,tileSize:s}=o.board,r=(e-t>0?d(e-t,s):d(e-t,s)-1)+R/2,a=n-i>0?d(n-i,s):d(n-i,s)-1;return R*(a+R/2)+r}({x:e.clientX-u.left,y:e.clientY-u.top});n===b?t.has(l)&&(o.draw.move.diskFrom=l,o.events.phase=g,m(o.draw.move.diskFrom),i()):n===g?s.has(l)&&(o.draw.move.diskTo=l,o.events.phase=k,function(e,n){const{generatedMoves:t}=o.draw;o.draw.dropRingMoves=new Set;for(let i=0;i<t.length;i+=1)e===t[i].diskFrom&&n===t[i].diskTo&&o.draw.dropRingMoves.add(t[i].ringTo)}(o.draw.move.diskFrom,o.draw.move.diskTo),i()):n===k&&c.has(l)&&(o.draw.move.ringTo=l,r(o.board,o.draw.move),o.events.phase=D,o.board.isBlueTurn=!o.board.isBlueTurn,o.draw.winner=S(o.draw.move),o.draw.move={diskFrom:-1,diskTo:-1,ringTo:-1},i(),null===o.draw.winner&&function(){const{board:e}=o;o.draw.lastMove=a(e),r(o.board,o.draw.lastMove),o.board.isBlueTurn=!o.board.isBlueTurn,o.draw.winner=S(o.draw.lastMove),null===o.draw.winner&&h()}())},handleMouseDown:function(e){const{screenX:n,screenY:t}=e;o.events.mouseDown={screenX:n,screenY:t},o.events.isMouseDown=!0,o.events.mouseButton=e.button},handleMouseMove:function(e){if(o.events.isMouseDown&&2===o.events.mouseButton){const n=e.screenX-o.events.mouseMove.screenX,t=e.screenY-o.events.mouseMove.screenY;o.board.canvasX+=n,o.board.canvasY+=t}const{clientX:n,clientY:t,screenX:s,screenY:r}=e;o.events.mouseMove={clientX:n,clientY:t,screenX:s,screenY:r},i()},handleMouseUp:function(e){const{screenX:n,screenY:t}=e;o.events.mouseUp={screenX:n,screenY:t},o.events.mouseButton=null,o.events.isMouseDown=!1},handleMouseWheel:function(e){const n=o.canvas.width,t=o.canvas.height,s=o.board.canvasX,r=o.board.canvasY;let{tileSize:d}=o.board;const a=(n/2-s)/d,c=(t/2-r)/d;d-=e.deltaY,d>100&&(d=100),d<10&&(d=10),o.board.tileSize=d,o.board.canvasX=n/2-d*a,o.board.canvasY=t/2-d*c,i()},restartPhases:h}},function(e,n,t){const{generateRandomMove:o}=t(5);e.exports={findBestMove:function(e){return o(e)}}},function(e,n,t){const{GRID_SIZE:o}=t(0),{isBlueDisk:i,isBlueRing:s,isRedDisk:r,isRedRing:d}=t(1),a=[[1,2,3],[o,2*o,3*o],[o+1,2*o+2,3*o+3],[o-1,2*o-2,3*o-3]];function c(e,n,t,o){const i=a[o];let s=1;for(const o of i){if(!t(e.grid[n+o]))break;s+=1}for(const o of i){if(!t(e.grid[n-o]))break;s+=1}return s>=4}function u(e,n,t){if(!t(e.grid[n]))return!1;for(let o=0;o<4;o+=1)if(c(e,n,t,o))return!0;return!1}e.exports={isBlueDiskWinAt:function(e,n){return u(e,n,i)},isRedDiskWinAt:function(e,n){return u(e,n,r)},isBlueRingWinAt:function(e,n){return u(e,n,s)},isRedRingWinAt:function(e,n){return u(e,n,d)}}}]);